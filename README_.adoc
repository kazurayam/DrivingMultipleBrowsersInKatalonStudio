= Testing a Blog system with 2 Chrome browsers in Katalon Studio

== Background

I have a Web Application to test. It is a runninng sample code presented by 
https://flask.palletsprojects.com/en/2.0.x/tutorial/["Flask Tutorial"]. It is _a basic blog application called Flaskr. Users will be able to register, log in, create posts, and edit or delete their own posts._ I just typed in the sample codes as published without any changes. At first, let me go through the pages to grasp what it is. Later I will describe how to set it up on your own PC.

I open Chrome browser to visit http://127.0.0.1/ . I see the index page as follows, which has no blog posts submitted yet.

image:./docs/images/test_flaskr/1_start_from_here.png[1,512,320]

At first, I need to register a User for me before creating posts. I click the `Register` link. Then a form is presented where I am requested to type a credential (username and password pair).

image:./docs/images/test_flaskr/2_going_to_register_a_username.png[2,512,640]

I click the `Register` button. I am transferred to the LogIn page.

image:./docs/images/test_flaskr/3_a_username_has_been_registered.png[3,512,640]

I re-type the credential (username and password) that I used to create my User.

image:./docs/images/test_flaskr/4_about_to_login.png[4,512,640]

I click the `Log In` button. Then I am transferred to the Index page. Please note that the username is displayed in the header. This implies that now I am logged-in the web application.

image:./docs/images/test_flaskr/5_the_user_have_logged_in.png[5,512,640]

Now I am going to create a new post. I click the `New` link. Then a empty form is displayed.

image:./docs/images/test_flaskr/6_opened_page_to_create_a_new_post.png[6,512,640]

I type a text into the `title` field, and a text into the `body` field.

image:./docs/images/test_flaskr/7_has_typed_texts_into_a_post.png[7,512,640]

I click the `Save` button. Then I am transferred to the index page. Please find a post has been saved into the Blob system and is now displayed in the list of posts.

image:./docs/images/test_flaskr/8_the_post_is_found_in_the_list.png[8,512,640]

== Problem to solve

You can easily imagine; I can create 2 or more users. So I should be able send multiple posts to http://127.0.0.1/ from 2 or more browsers simultaneously using 2 users each. When a user Alice made a post, then another user Bob should be able to see the post by Alice in an instant. When Bob made a new post, then soon Alice should be able to see the Bob's post.

This test scenario --- testing a web app with 2 browsers simultaneously --- is applicable to practical business. Let me assume I have a EC site which has dual user interface: Customer UI and Administrator UI. When a user submit an order to purchase some product, then an administrator should be able to see the order in the list of outstanding orders. I want to test both of the Customer UI and the Administrator UI. My Web UI test should submit an order in the Customer UI; then my test my test verify if the order is appearing in the Administrator UI. I want my test to simulate this dual-participants' interaction.

*But how can I do testing a web app with 2 browsers simultaneously in Katalon Studio?*

I can point out a problem : Katalon Studio's `WebUI.openBrowser()` keyword can not open 2 browsers.

== Solution

== Description

=== Target Web App

== Envrionment setup

=== Installing docker command

I installed `docker` command into my Mac Book Air

```
$ brew install docker
...
```

I checked if the `docker` command is running.

```
$ docker --version
Docker version 20.10.2, build 2291f61
:~
$ 
```

Windows users can use "Docker Desktop on Windnows" of course,

* https://docs.docker.com/desktop/windows/install/


=== Starting up HTTP Server App at http://127.0.0.1/

I made a temporary directory with any name.
```
$ cd ~
$ mkdir flaskr
```

In the temp directory, I started a web app using a docker image.

```
$ cd ~/flaskr
$ docker run -it -p 80:8080 --rm kazurayam/flaskr-kazurayam:1.0.3
Serving on http://0.0.0.0:8080
```

Or, you can use the following shell script in the root directory of this project.

* link:./startup_flaskr.sh[startup_flaskr.sh]
[source,shell]
----
include::./startup_flaskr.sh[]
----


Now I can open a browser and visit the following URL.

* http://127.0.0.1:80/

image:docs/images/flaskr_just_started.png[]

I made a docker image which is publicly available at Docker Hub :

* https://hub.docker.com/repository/docker/kazurayam/flaskr-kazurayam

== Web UI Test Scenario

1. I will use *Flaskr* at `http://127.0.0.1` as a partner for me to develop a set of Web UI test scripts in Katalon Studio.

2. I will open 2 Chrome browsers. On each, I will visit the Flaskr site and interact with it. I will keep 2 browsers open and operate on them simultaneously.

3. On one browser, I will register a user *Alice* and make some posts.

4. On another browser, I will register another user *Bob* and make some posts.

5. Alice should be able to read the posts made by Bob. Bob should be able to read the posts made by Alice. My web ui test in Katalon Studio will check this conversation.

== Experiments
